{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Student/Desktop/Fahrzeug/Fahrzeug-A2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _UpdateFahrzeugComponent_instances, _UpdateFahrzeugComponent_setProps, _UpdateFahrzeugComponent_handleFindError, _UpdateFahrzeugComponent_handleUpdateResult, _UpdateFahrzeugComponent_navigateHome;\n\nimport { __classPrivateFieldGet } from \"tslib\"; // eslint-disable-next-line @typescript-eslint/consistent-type-imports\n\nimport { FindError, UpdateError } from '../shared';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport log from 'loglevel';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../shared/error-message.component\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"./update-beschreibung.component\";\nimport * as i8 from \"./update-fahrzeugtyp.component\";\nimport * as i9 from \"./update-kennzeichen.component\";\nimport * as i10 from \"./update-kilometerstand.component\";\n\nfunction UpdateFahrzeugComponent_section_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"section\", 2)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 3)(4, \"form\", 4);\n    i0.ɵɵlistener(\"submit\", function UpdateFahrzeugComponent_section_0_Template_form_submit_4_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onSubmit());\n    });\n    i0.ɵɵelement(5, \"hs-update-kennzeichen\", 5)(6, \"hs-update-beschreibung\", 5)(7, \"hs-update-fahrzeugtyp\", 5)(8, \"hs-update-kilometerstand\", 5);\n    i0.ɵɵelementStart(9, \"div\", 6)(10, \"div\", 7)(11, \"button\", 8)(12, \"i\", 9);\n    i0.ɵɵtext(13, \"check\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"span\", 10);\n    i0.ɵɵtext(15, \"Stammdaten aktualisieren\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fahrzeug \", ctx_r0.fahrzeug.id, \":\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.updateForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"updateForm\", ctx_r0.updateForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"updateForm\", ctx_r0.updateForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"updateForm\", ctx_r0.updateForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"updateForm\", ctx_r0.updateForm);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.updateForm.pristine || ctx_r0.updateForm.invalid);\n  }\n}\n/**\r\n * component for the tag <code>hs-update-buch</code>\r\n */\n\n\nexport class UpdateFahrzeugComponent {\n  // eslint-disable-next-line max-params\n  constructor(service, readService, titleService, router, route) {\n    this.service = service;\n    this.readService = readService;\n    this.titleService = titleService;\n    this.router = router;\n    this.route = route;\n\n    _UpdateFahrzeugComponent_instances.add(this);\n\n    this.updateForm = new FormGroup({});\n    log.debug('UpdateFahrzeugComponent.constructor()');\n  }\n\n  ngOnInit() {\n    var _a; // path params from /fahrzeuge/:id/update\n\n\n    const id = (_a = this.route.snapshot.paramMap.get('id')) !== null && _a !== void 0 ? _a : undefined;\n    this.readService.findById(id).pipe(first(), tap(result => {\n      __classPrivateFieldGet(this, _UpdateFahrzeugComponent_instances, \"m\", _UpdateFahrzeugComponent_setProps).call(this, result);\n\n      log.debug('UpdateFahrzeugComponent.ngOnInit: fahrzeug=', this.fahrzeug);\n    })).subscribe();\n  }\n  /**\r\n   * Write back the recent data for the viewed fahrzeug-object\r\n   * @return false to cancel the event\r\n   */\n\n\n  onSubmit() {\n    if (this.updateForm.pristine || this.fahrzeug === undefined) {\n      log.debug('UpdateFahrzeugComponent.onSubmit: keine Änderungen');\n      return;\n    }\n\n    const {\n      beschreibung\n    } = this.updateForm.value;\n    const {\n      kennzeichen\n    } = this.updateForm.value;\n    const {\n      kilometerstand\n    } = this.updateForm.value;\n    const {\n      fahrzeugtype\n    } = this.updateForm.value;\n    const {\n      vorname\n    } = this.updateForm.value;\n    const {\n      nachname\n    } = this.updateForm.value;\n    const {\n      fahrzeug,\n      service\n    } = this; // erstzulassung can't be changed in the form\n\n    fahrzeug.beschreibung = beschreibung;\n    fahrzeug.fahrzeugtype = fahrzeugtype;\n    fahrzeug.kennzeichen = kennzeichen;\n    fahrzeug.kilometerstand = kilometerstand;\n    fahrzeug.fahrzeughalter.vorname = vorname;\n    fahrzeug.fahrzeughalter.nachname = nachname;\n    log.debug('UpdateFahrzeugComponent.onSubmit: fahrzeug=', fahrzeug);\n    service.update(fahrzeug).pipe(first(), tap(result => __classPrivateFieldGet(this, _UpdateFahrzeugComponent_instances, \"m\", _UpdateFahrzeugComponent_handleUpdateResult).call(this, result))).subscribe({\n      next: () => __classPrivateFieldGet(this, _UpdateFahrzeugComponent_instances, \"m\", _UpdateFahrzeugComponent_navigateHome).call(this)\n    });\n    return false;\n  }\n\n}\n_UpdateFahrzeugComponent_instances = new WeakSet(), _UpdateFahrzeugComponent_setProps = function _UpdateFahrzeugComponent_setProps(result) {\n  if (result instanceof FindError) {\n    __classPrivateFieldGet(this, _UpdateFahrzeugComponent_instances, \"m\", _UpdateFahrzeugComponent_handleFindError).call(this, result);\n\n    return;\n  }\n\n  this.fahrzeug = result;\n  this.errorMsg = undefined;\n  const titel = `Aktualisieren ${this.fahrzeug.id}`;\n  this.titleService.setTitle(titel);\n}, _UpdateFahrzeugComponent_handleFindError = function _UpdateFahrzeugComponent_handleFindError(err) {\n  const {\n    statuscode\n  } = err;\n  log.debug('UpdateFahrzeugComponent.#handleError: statuscode=', statuscode);\n  this.fahrzeug = undefined;\n\n  switch (statuscode) {\n    case 404\n    /* NotFound */\n    :\n      this.errorMsg = 'Kein Fahrzeug gefunden.';\n      break;\n\n    case 429\n    /* TooManyRequests */\n    :\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n\n    case 504\n    /* GatewayTimeout */\n    :\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n}, _UpdateFahrzeugComponent_handleUpdateResult = function _UpdateFahrzeugComponent_handleUpdateResult(result) {\n  if (!(result instanceof UpdateError)) {\n    return;\n  }\n\n  const {\n    statuscode\n  } = result;\n  log.debug('UpdateStammdatenComponent.#handleError: statuscode=', statuscode);\n\n  switch (statuscode) {\n    case 422\n    /* UnprocessableEntity */\n    :\n      {\n        const {\n          cause\n        } = result; // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n        this.errorMsg = cause instanceof HttpErrorResponse ? cause.error : JSON.stringify(cause);\n        break;\n      }\n\n    case 429\n    /* TooManyRequests */\n    :\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n\n    case 504\n    /* GatewayTimeout */\n    :\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n\n  log.debug('UpdateStammdatenComponent.#handleError: errorMsg=', this.errorMsg);\n}, _UpdateFahrzeugComponent_navigateHome = /*#__PURE__*/function () {\n  var _UpdateFahrzeugComponent_navigateHome2 = _asyncToGenerator(function* () {\n    yield this.router.navigate(['/']);\n  });\n\n  function _UpdateFahrzeugComponent_navigateHome() {\n    return _UpdateFahrzeugComponent_navigateHome2.apply(this, arguments);\n  }\n\n  return _UpdateFahrzeugComponent_navigateHome;\n}();\n\nUpdateFahrzeugComponent.ɵfac = function UpdateFahrzeugComponent_Factory(t) {\n  return new (t || UpdateFahrzeugComponent)(i0.ɵɵdirectiveInject(i1.FahrzeugWriteService), i0.ɵɵdirectiveInject(i1.FahrzeugReadService), i0.ɵɵdirectiveInject(i2.Title), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n};\n\nUpdateFahrzeugComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UpdateFahrzeugComponent,\n  selectors: [[\"hs-update-fahrzeug\"]],\n  decls: 2,\n  vars: 2,\n  consts: [[\"class\", \"mt-1 ms-1\", 4, \"ngIf\"], [3, \"text\"], [1, \"mt-1\", \"ms-1\"], [1, \"mt-2\", \"ms-2\"], [\"role\", \"form\", 3, \"formGroup\", \"submit\"], [3, \"updateForm\"], [1, \"row\"], [1, \"col\", \"offset-2\", \"gy-3\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"material-icons\"], [1, \"ms-1\"]],\n  template: function UpdateFahrzeugComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, UpdateFahrzeugComponent_section_0_Template, 16, 7, \"section\", 0);\n      i0.ɵɵelement(1, \"hs-error-message\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.fahrzeug);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"text\", ctx.errorMsg);\n    }\n  },\n  dependencies: [i4.NgIf, i5.ErrorMessageComponent, i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.FormGroupDirective, i7.UpdateBeschreibungComponent, i8.UpdateFahrzeugtypComponent, i9.UpdateKennzeichenComponent, i10.UpdateKilometerstandComponent],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["FindError","UpdateError","HttpErrorResponse","first","tap","FormGroup","log","i0","UpdateFahrzeugComponent","constructor","service","readService","titleService","router","route","debug","ngOnInit","id","snapshot","paramMap","get","_a","undefined","findById","pipe","result","__classPrivateFieldGet","_UpdateFahrzeugComponent_instances","_UpdateFahrzeugComponent_setProps","call","fahrzeug","subscribe","onSubmit","updateForm","pristine","beschreibung","value","kennzeichen","kilometerstand","fahrzeugtype","vorname","nachname","fahrzeughalter","update","_UpdateFahrzeugComponent_handleUpdateResult","next","_UpdateFahrzeugComponent_navigateHome","_UpdateFahrzeugComponent_handleFindError","errorMsg","titel","setTitle","err","statuscode","error","cause","JSON","stringify","navigate","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Student\\Desktop\\Fahrzeug\\Fahrzeug-A2\\src\\app\\fahrzeug\\update-fahrzeug\\update-fahrzeug.component.ts","C:\\Users\\Student\\Desktop\\Fahrzeug\\Fahrzeug-A2\\src\\app\\fahrzeug\\update-fahrzeug\\update-fahrzeug.component.html"],"sourcesContent":["import { ActivatedRoute, Router } from '@angular/router'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { Component, type OnInit } from '@angular/core';\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\nimport {\n    type Fahrzeug,\n    FahrzeugReadService,\n    FahrzeugWriteService,\n    type Fahrzeugtyp,\n    FindError,\n    UpdateError,\n} from '../shared';\nimport { HttpErrorResponse, HttpStatusCode } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport { Title } from '@angular/platform-browser'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport log from 'loglevel';\n\n/**\n * component for the tag <code>hs-update-buch</code>\n */\n@Component({\n    selector: 'hs-update-fahrzeug',\n    templateUrl: './update-fahrzeug.component.html',\n})\nexport class UpdateFahrzeugComponent implements OnInit {\n    fahrzeug: Fahrzeug | undefined;\n\n    readonly updateForm = new FormGroup({});\n\n    errorMsg: string | undefined;\n\n    // eslint-disable-next-line max-params\n    constructor(\n        private readonly service: FahrzeugWriteService,\n        private readonly readService: FahrzeugReadService,\n        private readonly titleService: Title,\n        private readonly router: Router,\n        private readonly route: ActivatedRoute,\n    ) {\n        log.debug('UpdateFahrzeugComponent.constructor()');\n    }\n\n    ngOnInit() {\n        // path params from /fahrzeuge/:id/update\n        const id = this.route.snapshot.paramMap.get('id') ?? undefined;\n\n        this.readService\n            .findById(id)\n            .pipe(\n                first(),\n                tap(result => {\n                    this.#setProps(result);\n                    log.debug(\n                        'UpdateFahrzeugComponent.ngOnInit: fahrzeug=',\n                        this.fahrzeug,\n                    );\n                }),\n            )\n            .subscribe();\n    }\n\n    /**\n     * Write back the recent data for the viewed fahrzeug-object\n     * @return false to cancel the event\n     */\n    onSubmit() {\n        if (this.updateForm.pristine || this.fahrzeug === undefined) {\n            log.debug('UpdateFahrzeugComponent.onSubmit: keine Änderungen');\n            return;\n        }\n\n        const { beschreibung } = this.updateForm.value as {\n            beschreibung: string;\n        };\n        const { kennzeichen } = this.updateForm.value as {\n            kennzeichen: string;\n        };\n        const { kilometerstand } = this.updateForm.value as {\n            kilometerstand: number;\n        };\n        const { fahrzeugtype } = this.updateForm.value as {\n            fahrzeugtype: Fahrzeugtyp;\n        };\n        const { vorname } = this.updateForm.value as { vorname: string };\n        const { nachname } = this.updateForm.value as { nachname: string };\n\n        const { fahrzeug, service } = this;\n\n        // erstzulassung can't be changed in the form\n        fahrzeug.beschreibung = beschreibung;\n        fahrzeug.fahrzeugtype = fahrzeugtype;\n        fahrzeug.kennzeichen = kennzeichen;\n        fahrzeug.kilometerstand = kilometerstand;\n        fahrzeug.fahrzeughalter.vorname = vorname;\n        fahrzeug.fahrzeughalter.nachname = nachname;\n\n        log.debug('UpdateFahrzeugComponent.onSubmit: fahrzeug=', fahrzeug);\n\n        service\n            .update(fahrzeug)\n            .pipe(\n                first(),\n                tap(result => this.#handleUpdateResult(result)),\n            )\n            .subscribe({ next: () => this.#navigateHome() });\n        return false;\n    }\n\n    #setProps(result: Fahrzeug | FindError) {\n        if (result instanceof FindError) {\n            this.#handleFindError(result);\n            return;\n        }\n\n        this.fahrzeug = result;\n        this.errorMsg = undefined;\n\n        const titel = `Aktualisieren ${this.fahrzeug.id}`;\n        this.titleService.setTitle(titel);\n    }\n\n    #handleFindError(err: FindError) {\n        const { statuscode } = err;\n        log.debug(\n            'UpdateFahrzeugComponent.#handleError: statuscode=',\n            statuscode,\n        );\n\n        this.fahrzeug = undefined;\n\n        switch (statuscode) {\n            case HttpStatusCode.NotFound:\n                this.errorMsg = 'Kein Fahrzeug gefunden.';\n                break;\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n    }\n\n    #handleUpdateResult(result: Fahrzeug | UpdateError) {\n        if (!(result instanceof UpdateError)) {\n            return;\n        }\n\n        const { statuscode } = result;\n        log.debug(\n            'UpdateStammdatenComponent.#handleError: statuscode=',\n            statuscode,\n        );\n\n        switch (statuscode) {\n            case HttpStatusCode.UnprocessableEntity: {\n                const { cause } = result;\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this.errorMsg =\n                    cause instanceof HttpErrorResponse\n                        ? cause.error\n                        : JSON.stringify(cause);\n                break;\n            }\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n\n        log.debug(\n            'UpdateStammdatenComponent.#handleError: errorMsg=',\n            this.errorMsg,\n        );\n    }\n\n    async #navigateHome() {\n        await this.router.navigate(['/']);\n    }\n}\n","<section class=\"mt-1 ms-1\" *ngIf=\"fahrzeug\">\n  <h4>Fahrzeug {{ fahrzeug.id }}:</h4>\n  <div class=\"mt-2 ms-2\">\n    <form [formGroup]=\"updateForm\" role=\"form\" (submit)=\"onSubmit()\">\n      <hs-update-kennzeichen [updateForm]=\"updateForm\"></hs-update-kennzeichen>\n      <hs-update-beschreibung\n        [updateForm]=\"updateForm\"\n      ></hs-update-beschreibung>\n      <hs-update-fahrzeugtyp [updateForm]=\"updateForm\"></hs-update-fahrzeugtyp>\n      <hs-update-kilometerstand\n        [updateForm]=\"updateForm\"\n      ></hs-update-kilometerstand>\n\n      <div class=\"row\">\n        <div class=\"col offset-2 gy-3\">\n          <!-- form.pristine ist das Gegenteil von form.dirty -->\n          <button\n            type=\"submit\"\n            class=\"btn btn-primary\"\n            [disabled]=\"updateForm.pristine || updateForm.invalid\"\n          >\n            <i class=\"material-icons\">check</i>\n            <span class=\"ms-1\">Stammdaten aktualisieren</span>\n          </button>\n        </div>\n      </div>\n    </form>\n  </div>\n</section>\n\n<hs-error-message [text]=\"errorMsg\"></hs-error-message>\n"]},"metadata":{},"sourceType":"module"}